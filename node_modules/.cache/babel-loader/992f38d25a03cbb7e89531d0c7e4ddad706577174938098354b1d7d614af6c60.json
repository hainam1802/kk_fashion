{"ast":null,"code":"import axios from \"axios\";\nimport store from \"./../store/reducers/index\";\nimport { hideLoading, showLoading } from \"react-redux-loading-bar\";\nconst url = {\n  baseUrl: \"https://restfulapi.dnd-group.net/api\",\n  login: \"/login\",\n  majors: \"/majors\",\n  //bên trái là của js bên phải là của api\n  students: \"/students\" //bên trái là của js bên phải là của api\n};\n\nconst instance = axios.create({\n  baseURL: url.baseUrl,\n  headers: {\n    \"Content-Type\": \"application/json\",\n    Accept: \"application/json\"\n  }\n});\ninstance.interceptors.request.use(request => {\n  const state = store.getState();\n  if (state.auth.token) {\n    request.headers.Authorization = `Bearer ${state.auth.token}`;\n  }\n  store.dispatch(showLoading());\n  return request;\n});\ninstance.interceptors.response.use(response => {\n  setTimeout(() => store.dispatch(hideLoading()), 100);\n  return response.data;\n},\n// thanh cong\n\nerr => {\n  // loi\n  setTimeout(() => store.dispatch(hideLoading()), 100);\n  if (err.code === \"ERR_NETWORK\") {\n    // loi do nha mang\n    window.location.href = \"/network-error\"; // quay ve trang trang network error\n  } else {\n    switch (err.response.status) {\n      case 401:\n        window.location.href = \"/login\";\n        break;\n      case 403:\n        window.location.href = \"/no-permission\";\n        break;\n      default:\n        break;\n    }\n  }\n  return Promise.reject(err);\n});\nconst api = {\n  url,\n  instance,\n  get: instance.get,\n  post: instance.post,\n  put: instance.put,\n  delete: instance.delete,\n  patch: instance.patch\n};\nexport default api;","map":{"version":3,"names":["axios","store","hideLoading","showLoading","url","baseUrl","login","majors","students","instance","create","baseURL","headers","Accept","interceptors","request","use","state","getState","auth","token","Authorization","dispatch","response","setTimeout","data","err","code","window","location","href","status","Promise","reject","api","get","post","put","delete","patch"],"sources":["C:/xampp/htdocs/kk_fashion/src/services/api.js"],"sourcesContent":["import axios from \"axios\";\r\nimport store from \"./../store/reducers/index\"\r\nimport {hideLoading, showLoading} from \"react-redux-loading-bar\";\r\n\r\nconst url = {\r\n    baseUrl: \"https://restfulapi.dnd-group.net/api\",\r\n    login: \"/login\",\r\n    majors: \"/majors\", //bên trái là của js bên phải là của api\r\n    students: \"/students\", //bên trái là của js bên phải là của api\r\n\r\n};\r\n\r\nconst instance = axios.create({\r\n    baseURL: url.baseUrl,\r\n    headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Accept: \"application/json\",\r\n    },\r\n});\r\n\r\ninstance.interceptors.request.use((request) =>{\r\n        const state = store.getState();\r\n        if (state.auth.token){\r\n            request.headers.Authorization =  `Bearer ${state.auth.token}`\r\n        }\r\n        store.dispatch(showLoading())\r\n        return request;\r\n    }\r\n);\r\n\r\ninstance.interceptors.response.use(\r\n    (response) =>{\r\n        setTimeout(()=>store.dispatch(hideLoading()),100)\r\n        return response.data\r\n    } , // thanh cong\r\n\r\n    (err) => { // loi\r\n        setTimeout(()=>store.dispatch(hideLoading()),100)\r\n\r\n        if (err.code === \"ERR_NETWORK\") { // loi do nha mang\r\n            window.location.href = \"/network-error\"; // quay ve trang trang network error\r\n        } else {\r\n            switch (err.response.status) {\r\n                case 401:\r\n                    window.location.href = \"/login\";\r\n                    break;\r\n                case 403:\r\n                    window.location.href = \"/no-permission\";\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n        return Promise.reject(err);\r\n    }\r\n);\r\n\r\nconst api = {\r\n    url,\r\n    instance,\r\n    get: instance.get,\r\n    post: instance.post,\r\n    put: instance.put,\r\n    delete: instance.delete,\r\n    patch: instance.patch,\r\n};\r\n\r\nexport default api;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,KAAK,MAAM,2BAA2B;AAC7C,SAAQC,WAAW,EAAEC,WAAW,QAAO,yBAAyB;AAEhE,MAAMC,GAAG,GAAG;EACRC,OAAO,EAAE,sCAAsC;EAC/CC,KAAK,EAAE,QAAQ;EACfC,MAAM,EAAE,SAAS;EAAE;EACnBC,QAAQ,EAAE,WAAW,CAAE;AAE3B,CAAC;;AAED,MAAMC,QAAQ,GAAGT,KAAK,CAACU,MAAM,CAAC;EAC1BC,OAAO,EAAEP,GAAG,CAACC,OAAO;EACpBO,OAAO,EAAE;IACL,cAAc,EAAE,kBAAkB;IAClCC,MAAM,EAAE;EACZ;AACJ,CAAC,CAAC;AAEFJ,QAAQ,CAACK,YAAY,CAACC,OAAO,CAACC,GAAG,CAAED,OAAO,IAAI;EACtC,MAAME,KAAK,GAAGhB,KAAK,CAACiB,QAAQ,EAAE;EAC9B,IAAID,KAAK,CAACE,IAAI,CAACC,KAAK,EAAC;IACjBL,OAAO,CAACH,OAAO,CAACS,aAAa,GAAK,UAASJ,KAAK,CAACE,IAAI,CAACC,KAAM,EAAC;EACjE;EACAnB,KAAK,CAACqB,QAAQ,CAACnB,WAAW,EAAE,CAAC;EAC7B,OAAOY,OAAO;AAClB,CAAC,CACJ;AAEDN,QAAQ,CAACK,YAAY,CAACS,QAAQ,CAACP,GAAG,CAC7BO,QAAQ,IAAI;EACTC,UAAU,CAAC,MAAIvB,KAAK,CAACqB,QAAQ,CAACpB,WAAW,EAAE,CAAC,EAAC,GAAG,CAAC;EACjD,OAAOqB,QAAQ,CAACE,IAAI;AACxB,CAAC;AAAG;;AAEHC,GAAG,IAAK;EAAE;EACPF,UAAU,CAAC,MAAIvB,KAAK,CAACqB,QAAQ,CAACpB,WAAW,EAAE,CAAC,EAAC,GAAG,CAAC;EAEjD,IAAIwB,GAAG,CAACC,IAAI,KAAK,aAAa,EAAE;IAAE;IAC9BC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,gBAAgB,CAAC,CAAC;EAC7C,CAAC,MAAM;IACH,QAAQJ,GAAG,CAACH,QAAQ,CAACQ,MAAM;MACvB,KAAK,GAAG;QACJH,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;QAC/B;MACJ,KAAK,GAAG;QACJF,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,gBAAgB;QACvC;MACJ;QACI;IAAM;EAElB;EACA,OAAOE,OAAO,CAACC,MAAM,CAACP,GAAG,CAAC;AAC9B,CAAC,CACJ;AAED,MAAMQ,GAAG,GAAG;EACR9B,GAAG;EACHK,QAAQ;EACR0B,GAAG,EAAE1B,QAAQ,CAAC0B,GAAG;EACjBC,IAAI,EAAE3B,QAAQ,CAAC2B,IAAI;EACnBC,GAAG,EAAE5B,QAAQ,CAAC4B,GAAG;EACjBC,MAAM,EAAE7B,QAAQ,CAAC6B,MAAM;EACvBC,KAAK,EAAE9B,QAAQ,CAAC8B;AACpB,CAAC;AAED,eAAeL,GAAG"},"metadata":{},"sourceType":"module","externalDependencies":[]}